<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build a Boat for Treasure! 3D</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- INPUT METHOD SELECTION SCREEN -->
    <div id="input-select-screen">
        <div class="input-select-content">
            <h1>Choose Your Controls</h1>
            <p class="input-select-sub">How would you like to play?</p>
            <div class="input-select-grid">
                <div class="input-select-card" onclick="selectInputMethod('touchscreen')">
                    <div class="input-select-icon touch-icon">
                        <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                            <rect x="15" y="5" width="50" height="70" rx="8" stroke="#1e90ff" stroke-width="3" fill="rgba(30,144,255,0.15)"/>
                            <circle cx="40" cy="62" r="5" fill="#1e90ff"/>
                            <rect x="22" y="12" width="36" height="40" rx="3" fill="rgba(30,144,255,0.3)"/>
                        </svg>
                    </div>
                    <div class="input-select-label">Touchscreen</div>
                    <div class="input-select-desc">Mobile &amp; iPad<br>Virtual joystick + tap controls</div>
                </div>
                <div class="input-select-card" onclick="selectInputMethod('keyboard')">
                    <div class="input-select-icon kb-icon">
                        <svg width="90" height="60" viewBox="0 0 90 60" fill="none">
                            <rect x="2" y="2" width="86" height="56" rx="8" stroke="#ffd700" stroke-width="3" fill="rgba(255,215,0,0.1)"/>
                            <rect x="10" y="10" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="26" y="10" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="42" y="10" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="58" y="10" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="14" y="24" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="30" y="24" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="46" y="24" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="62" y="24" width="12" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                            <rect x="22" y="40" width="46" height="10" rx="2" fill="rgba(255,215,0,0.35)"/>
                        </svg>
                    </div>
                    <div class="input-select-label">Keyboard</div>
                    <div class="input-select-desc">Desktop / Laptop<br>WASD + mouse controls</div>
                </div>
            </div>
        </div>
    </div>

    <!-- TITLE SCREEN -->
    <div id="title-screen" style="display:none;">
        <div class="title-content">
            <h1>Build a Boat<br><span>for Treasure!</span></h1>
            <p class="tag3d">3D Edition</p>
            <p class="subtitle">Place blocks, build your boat, survive the river, find the treasure!</p>
            <button id="play-btn" onclick="startGame()">PLAY</button>
            <div class="instructions-preview" id="instructions-keyboard">
                <p><strong>How to Play:</strong></p>
                <p>1. WASD to walk, click grid to place blocks</p>
                <p>2. Click block faces to build up!</p>
                <p>3. Right-click to remove blocks</p>
                <p>4. Walk to LAUNCH button and click it!</p>
                <p><strong>Sailing Controls:</strong></p>
                <p>W = Speed Up | S = Brake/Reverse</p>
                <p>A = Steer Left | D = Steer Right</p>
            </div>
            <div class="instructions-preview" id="instructions-touch" style="display:none;">
                <p><strong>How to Play:</strong></p>
                <p>1. Use joystick (left) to walk around</p>
                <p>2. Tap on grid to place blocks</p>
                <p>3. Hold REMOVE then tap to delete blocks</p>
                <p>4. Tap SAIL! button to launch!</p>
                <p><strong>Sailing Controls:</strong></p>
                <p>Joystick = Steer left/right &amp; speed</p>
                <p>SPEED UP / BRAKE buttons on right</p>
            </div>
        </div>
        <canvas id="title-bg-canvas"></canvas>
    </div>

    <!-- GAME SCREEN -->
    <div id="game-screen" style="display:none;">
        <!-- HUD -->
        <div id="hud">
            <div id="hud-left">
                <div class="hud-item">
                    <span class="hud-label">Gold:</span>
                    <span id="gold-display">0</span>
                </div>
                <div class="hud-item">
                    <span class="hud-label">Stage:</span>
                    <span id="stage-display">Building</span>
                </div>
            </div>
            <div id="hud-center">
                <span id="game-message"></span>
            </div>
            <div id="hud-right">
                <div class="hud-item">
                    <span class="hud-label">HP:</span>
                    <div id="hp-bar-container">
                        <div id="hp-bar"></div>
                    </div>
                    <span id="hp-text">100</span>
                </div>
            </div>
        </div>

        <!-- BUILDING PANEL (left sidebar) -->
        <div id="build-panel">
            <h3>Inventory</h3>
            <div id="block-list"></div>
            <div id="build-actions">
                <button id="clear-btn" onclick="clearBoat()">Clear All</button>
                <button id="sail-btn" onclick="startSailing()">SAIL!</button>
            </div>
        </div>

        <!-- TEAM SELECT OVERLAY -->
        <div id="team-select-overlay" style="display:none;">
            <div class="team-select-box">
                <h2>Choose Your Team!</h2>
                <p class="team-select-sub">Compete with your team across all voyages</p>
                <div class="team-grid">
                    <div class="team-card" data-team="red" onclick="selectTeam('red')">
                        <div class="team-swatch" style="background:#DD3333;"></div>
                        <div class="team-card-name">Red Raiders</div>
                        <div class="team-card-score">Score: <span id="ts-red">0</span></div>
                    </div>
                    <div class="team-card" data-team="blue" onclick="selectTeam('blue')">
                        <div class="team-swatch" style="background:#3366CC;"></div>
                        <div class="team-card-name">Blue Buccaneers</div>
                        <div class="team-card-score">Score: <span id="ts-blue">0</span></div>
                    </div>
                    <div class="team-card" data-team="green" onclick="selectTeam('green')">
                        <div class="team-swatch" style="background:#33AA44;"></div>
                        <div class="team-card-name">Green Gators</div>
                        <div class="team-card-score">Score: <span id="ts-green">0</span></div>
                    </div>
                    <div class="team-card" data-team="yellow" onclick="selectTeam('yellow')">
                        <div class="team-swatch" style="background:#DDAA00;"></div>
                        <div class="team-card-name">Yellow Yachts</div>
                        <div class="team-card-score">Score: <span id="ts-yellow">0</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TEAM LEADERBOARD (HUD) -->
        <div id="team-leaderboard" style="display:none;">
            <div class="lb-title">Teams</div>
            <div id="lb-entries"></div>
        </div>

        <!-- CHAT BOX -->
        <div id="chat-box">
            <div id="chat-messages"></div>
            <div id="chat-input-row">
                <input type="text" id="chat-input" placeholder='Press "/" to chat...' maxlength="100" autocomplete="off">
                <button id="chat-send-btn" onclick="sendPlayerChat()">Send</button>
            </div>
        </div>

        <!-- TOUCH CONTROLS (only visible in touchscreen mode) -->
        <div id="touch-controls" style="display:none;">
            <!-- D-Pad / Joystick (left side) -->
            <div id="joystick-zone">
                <div id="joystick-base">
                    <div id="joystick-thumb"></div>
                </div>
            </div>

            <!-- Right side: JUMP button (big, always visible) + action row -->
            <div id="touch-right-side">
                <!-- Big jump button like a game controller A button -->
                <button id="touch-jump-btn" class="touch-btn-round touch-btn-jump">JUMP</button>

                <!-- Build mode buttons -->
                <div id="touch-build-actions">
                    <button id="touch-remove-btn" class="touch-btn touch-btn-danger">REMOVE</button>
                    <button id="touch-sail-btn" class="touch-btn touch-btn-gold">SAIL!</button>
                </div>

                <!-- Sail mode buttons -->
                <div id="touch-sail-controls" style="display:none;">
                    <button id="touch-accel-btn" class="touch-btn touch-btn-speed">SPEED UP</button>
                    <button id="touch-brake-btn" class="touch-btn touch-btn-danger">BRAKE</button>
                </div>
            </div>
        </div>

        <!-- 3D Renderer container -->
        <div id="renderer-container"></div>

        <!-- Distance bar overlay (sailing) -->
        <div id="distance-bar-container" style="display:none;">
            <div id="distance-text">0m / 1000m</div>
            <div id="distance-bar-bg">
                <div id="distance-bar-fill"></div>
            </div>
            <div id="distance-label">Treasure!</div>
        </div>

        <!-- RESULTS OVERLAY -->
        <div id="results-overlay" style="display:none;">
            <div class="results-box">
                <h2 id="results-title">Results</h2>
                <p id="results-distance"></p>
                <p id="results-gold"></p>
                <p id="results-bonus"></p>
                <p id="results-team-contribution" style="display:none;"></p>
                <div id="results-team-standings" style="display:none;">
                    <div class="results-lb-title">Team Standings</div>
                    <div id="results-lb-entries"></div>
                </div>
                <div class="results-buttons">
                    <button onclick="goToBuild()">Build Again</button>
                    <button onclick="goToShop()">Shop</button>
                </div>
            </div>
        </div>

        <!-- SHOP OVERLAY -->
        <div id="shop-overlay" style="display:none;">
            <div class="shop-box">
                <h2>Block Shop</h2>
                <p>Gold: <span id="shop-gold">0</span></p>
                <div id="shop-items"></div>
                <button onclick="closeShop()">Close</button>
            </div>
        </div>

        <!-- ADMIN PANEL -->
        <button id="admin-toggle-btn" onclick="toggleAdmin()">ADMIN</button>
        <div id="admin-overlay" style="display:none;">
            <div class="admin-box">
                <div class="admin-header">
                    <h2>Admin Panel</h2>
                    <button class="admin-close-btn" onclick="toggleAdmin()">X</button>
                </div>

                <!-- Tabs -->
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="adminTab('gold')">Gold</button>
                    <button class="admin-tab" onclick="adminTab('blocks')">Blocks</button>
                    <button class="admin-tab" onclick="adminTab('game')">Game</button>
                    <button class="admin-tab" onclick="adminTab('spawn')">Spawn</button>
                </div>

                <!-- Gold Tab -->
                <div id="admin-tab-gold" class="admin-tab-content active">
                    <p class="admin-label">Current Gold: <span id="admin-gold-display">0</span></p>
                    <div class="admin-row">
                        <button onclick="adminGiveGold(100)">+100</button>
                        <button onclick="adminGiveGold(500)">+500</button>
                        <button onclick="adminGiveGold(1000)">+1K</button>
                        <button onclick="adminGiveGold(10000)">+10K</button>
                        <button onclick="adminGiveGold(100000)">+100K</button>
                    </div>
                    <div class="admin-row">
                        <button onclick="adminSetGold(0)">Set 0</button>
                        <button onclick="adminSetGold(9999999)">MAX</button>
                    </div>
                </div>

                <!-- Blocks Tab -->
                <div id="admin-tab-blocks" class="admin-tab-content">
                    <div class="admin-row">
                        <button onclick="adminUnlockAll()">Unlock All Blocks</button>
                        <button onclick="adminGiveAllBlocks(50)">+50 Each</button>
                        <button onclick="adminGiveAllBlocks(999)">+999 Each</button>
                    </div>
                    <p class="admin-label">Give Specific Block:</p>
                    <div class="admin-row">
                        <select id="admin-block-select"></select>
                        <input type="number" id="admin-block-amount" value="50" min="1" max="9999" style="width:60px;">
                        <button onclick="adminGiveBlock()">Give</button>
                    </div>
                </div>

                <!-- Game Tab -->
                <div id="admin-tab-game" class="admin-tab-content">
                    <p class="admin-label">Stage: <span id="admin-stage-display">1</span></p>
                    <div class="admin-row">
                        <button onclick="adminSetStage(1)">Stage 1</button>
                        <button onclick="adminSetStage(2)">Stage 2</button>
                        <button onclick="adminSetStage(3)">Stage 3</button>
                        <button onclick="adminSetStage(4)">Stage 4</button>
                        <button onclick="adminSetStage(5)">Stage 5</button>
                    </div>
                    <p class="admin-label">Player:</p>
                    <div class="admin-row">
                        <button onclick="adminGodMode()">Toggle God Mode</button>
                        <button onclick="adminSetSpeed(12)">2x Speed</button>
                        <button onclick="adminSetSpeed(6)">Normal Speed</button>
                    </div>
                    <p class="admin-label">Boat (during sailing):</p>
                    <div class="admin-row">
                        <button onclick="adminHealBoat()">Full Heal</button>
                        <button onclick="adminBoostBoat()">Speed Boost</button>
                    </div>
                    <div class="admin-row">
                        <button onclick="adminWinStage()">Win Stage</button>
                        <button onclick="adminResetSave()">Reset Save</button>
                    </div>
                </div>

                <!-- Spawn Tab -->
                <div id="admin-tab-spawn" class="admin-tab-content">
                    <p class="admin-label">Spawn Bots:</p>
                    <div class="admin-row">
                        <button onclick="adminSpawnBots(5)">+5 Bots</button>
                        <button onclick="adminSpawnBots(10)">+10 Bots</button>
                        <button onclick="adminClearBots()">Remove Bots</button>
                    </div>
                    <p class="admin-label">Fill Grid:</p>
                    <div class="admin-row">
                        <select id="admin-fill-block-select"></select>
                        <button onclick="adminFillGrid()">Fill Base</button>
                        <button onclick="adminFillGridFull()">Fill 3 High</button>
                    </div>
                    <p class="admin-label">Team Scores:</p>
                    <div class="admin-row">
                        <button onclick="adminAddTeamScore('red', 500)">Red +500</button>
                        <button onclick="adminAddTeamScore('blue', 500)">Blue +500</button>
                        <button onclick="adminAddTeamScore('green', 500)">Green +500</button>
                        <button onclick="adminAddTeamScore('yellow', 500)">Yellow +500</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="game.js"></script>
</body>
</html>
